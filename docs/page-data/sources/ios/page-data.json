{"componentChunkName":"component---src-templates-page-js","path":"/sources/ios/","result":{"data":{"markdownRemark":{"frontmatter":{"path":"/sources/ios/","title":""}}},"pageContext":{"html":"\n    <section>\n      \n    <div class=\"toc\">\n      <div class=\"toc-sticky\">\n        <h6>On this Page:</h6>\n        <ul><li><a href=\"#getting-started\">Getting Started</a></li> <li><a href=\"#install-the-sdk\">Install the SDK</a></li> <li><a href=\"#identify-your-users\">Identify Your Users</a></li> <li><a href=\"#track-your-users-actions\">Track Your Usersâ€™ Actions</a></li> <li><a href=\"#queue-flushing\">Queue Flushing</a></li> <li><a href=\"#submitting-to-the-app-store\">Submitting to the App Store</a></li></ul>\n      </div>\n    </div>\n  \n      <html><head></head><body><h1 id=\"ios\" style=\"position:relative;\" data-tags=\"sources\"><a href=\"#\" aria-label=\"ios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>iOS</h1>\n<h2 id=\"getting-started\" style=\"position:relative;\"><a href=\"#getting-started\" aria-label=\"getting started permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Getting Started</h2>\n<p>Using our analytics-iOS library, you can start sending customer data from your app to MetaRouter, giving you valuable user data that yields actionable insights for your business. Follow the steps below to get started in only a few minutes.</p>\n<h3 id=\"create-an-ios-source-in-the-metarouter-ui\" style=\"position:relative;\"><a href=\"#create-an-ios-source-in-the-metarouter-ui\" aria-label=\"create an ios source in the metarouter ui permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Create an iOS Source in the MetaRouter UI</h3>\n<p>After logging in with your MetaRouter credentials, add a new <strong>Source &gt; iOS</strong>. Give your source a friendly name and copy that <strong>Source ID</strong> for the next step.</p>\n<h2 id=\"install-the-sdk\" style=\"position:relative;\"><a href=\"#install-the-sdk\" aria-label=\"install the sdk permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Install the SDK</h2>\n<p>We recommend installing Analytics-iOS via <a href=\"https://cocoapods.org/pods/AstronomerAnalytics\">Cocoapods</a> as it allows you to create a build with specific destinations and makes it simple to install and upgrade.</p>\n<p>Just add the Analytics dependency to your Podfile with:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Pod `&apos;Analytics&apos;, &apos;~&gt; 3.0&apos;`</code></pre></div>\n<p>Then, run a pod install inside your terminal, or from CocoaPods.app. Then, in your applicaton delegate&apos;s <code class=\"language-text\">application:didFinishLaunchingWithOptions:</code> method, set up the SDK like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"objectivec\"><pre class=\"language-objectivec\"><code class=\"language-objectivec\">SEGAnalyticsConfiguration <span class=\"token operator\">*</span>configuration <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>SEGAnalyticsConfiguration configurationWithWriteKey<span class=\"token punctuation\">:</span><span class=\"token string\">@&quot;YOUR_SOURCE_ID&quot;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\nconfiguration<span class=\"token punctuation\">.</span>trackApplicationLifecycleEvents <span class=\"token operator\">=</span> YES<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Enable this to record certain application events automatically</span>\nconfiguration<span class=\"token punctuation\">.</span>recordScreenViews <span class=\"token operator\">=</span> YES<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Enable this to record screen views automatically</span>\nconfiguration<span class=\"token punctuation\">.</span>requestFactory <span class=\"token operator\">=</span> <span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>NSURL <span class=\"token operator\">*</span>url<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        NSURLComponents <span class=\"token operator\">*</span>components <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>NSURLComponents componentsWithURL<span class=\"token punctuation\">:</span>url resolvingAgainstBaseURL<span class=\"token punctuation\">:</span>NO<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        NSString<span class=\"token operator\">*</span> host <span class=\"token operator\">=</span> components<span class=\"token punctuation\">.</span>host<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>host isEqualToString<span class=\"token punctuation\">:</span><span class=\"token string\">@&quot;cdn-settings.segment.com&quot;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            components<span class=\"token punctuation\">.</span>host <span class=\"token operator\">=</span> <span class=\"token string\">@&quot;cdn.metarouter.io&quot;</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>host isEqualToString<span class=\"token punctuation\">:</span><span class=\"token string\">@&quot;api.segment.io&quot;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            components<span class=\"token punctuation\">.</span>host <span class=\"token operator\">=</span> <span class=\"token string\">@&quot;e.metarouter.io&quot;</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        NSURL <span class=\"token operator\">*</span>transformedURL <span class=\"token operator\">=</span> components<span class=\"token punctuation\">.</span>URL<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>NSMutableURLRequest requestWithURL<span class=\"token punctuation\">:</span>transformedURL<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span>SEGAnalytics setupWithConfiguration<span class=\"token punctuation\">:</span>configuration<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Here, you&apos;ll need to place <code class=\"language-text\">YOUR_SOURCE_ID</code> with the Source ID for this particular project.</p>\n<p><strong>Note:</strong> Automatically tracking lifecycle events (Application Opened, Application Installed, Application Updated) and screen views is optional via initialization config parameters, but highly recommended to hit the ground running with core events!</p>\n<p>And of course, import the SDK in the files that you use it with:</p>\n<div class=\"gatsby-highlight\" data-language=\"objectivec\"><pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token macro property\">#<span class=\"token directive keyword\">import</span> &lt;Analytics/SEGAnalytics.h&gt;</span></code></pre></div>\n<p>Now that you have the SDK installed and setup, you are ready to start building out functionality. Keep reading to learn how to use the <code class=\"language-text\">identify</code> call on your app.</p>\n<h2 id=\"identify-your-users\" style=\"position:relative;\"><a href=\"#identify-your-users\" aria-label=\"identify your users permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Identify Your Users</h2>\n<p>The <code class=\"language-text\">identify</code> method helps you associate your users and their actions to a unique and recognizable <code class=\"language-text\">userID</code> and any optional <code class=\"language-text\">traits</code> that you know about them. We recommend calling an <code class=\"language-text\">identify</code> a single time - when the user&apos;s account is first created and only again when their traits change.</p>\n<p><strong>Note:</strong> Users are automatically assigned an anonymousID before you identify them. The userID is then what connects anonymous activity across mobile iOS devices.</p>\n<p>For example, a simple <code class=\"language-text\">identify</code> looks something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"objectivec\"><pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>SEGAnalytics sharedAnalytics<span class=\"token punctuation\">]</span> identify<span class=\"token punctuation\">:</span><span class=\"token string\">@&quot;123456&quot;</span>\n                                traits<span class=\"token punctuation\">:</span><span class=\"token operator\">@</span><span class=\"token punctuation\">{</span> <span class=\"token string\">@&quot;name&quot;</span><span class=\"token punctuation\">:</span> <span class=\"token string\">&quot;Dagny Smith&quot;</span>\n                                          <span class=\"token string\">@&quot;email&quot;</span><span class=\"token punctuation\">:</span> <span class=\"token string\">&quot;dagny@metarouter.io&quot;</span><span class=\"token punctuation\">,</span>\n                                          <span class=\"token string\">@&quot;role&quot;</span><span class=\"token punctuation\">:</span> <span class=\"token string\">&quot;buyer&quot;</span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This call is identifying a user by her unique <code class=\"language-text\">userID</code> (from your database) and associating her with <code class=\"language-text\">name</code>, <code class=\"language-text\">email</code>, and <code class=\"language-text\">role</code> traits.</p>\n<p><strong>Note:</strong> When you add an <code class=\"language-text\">identify</code> to your iOS app, you will need to replace all those hard-coded strings with details about the currently logged-in user.</p>\n<p>Once you have the <code class=\"language-text\">identify</code> call implemented, you&apos;re ready to move on to the <code class=\"language-text\">track</code> call.</p>\n<h2 id=\"track-your-users-actions\" style=\"position:relative;\"><a href=\"#track-your-users-actions\" aria-label=\"track your users actions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Track Your Users&#x2019; Actions</h2>\n<p>To get to a more complete event tracking analytics setup, you can add a <code class=\"language-text\">track</code> call to your app. This will tell MetaRouter which actions users are performing in your app. With <code class=\"language-text\">track</code>, each user action triggers an &#x201C;event&#x201D;, which can also have associated properties.</p>\n<p>To start, our SDK can automatically track a few common events (e.g. <code class=\"language-text\">Application_Installed</code>, <code class=\"language-text\">Application_Opened</code>, and <code class=\"language-text\">Application_Updated</code>) - you will just need to enable this option during initialization. In addition to these, you will likely want to track some events that are success indicators for your app - like Viewed Product, Email Sign Up, Item Purchased, etc.</p>\n<p>Setting up a <code class=\"language-text\">track</code> is very similar to the process you just went through to set up an <code class=\"language-text\">identify</code>. Here&#x2019;s the basic, sample <code class=\"language-text\">track</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"objectivec\"><pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>SEGAnalytics sharedAnalytics<span class=\"token punctuation\">]</span> track<span class=\"token punctuation\">:</span><span class=\"token string\">@&quot;Item Purchased&quot;</span><span class=\"token punctuation\">,</span>\n                           properties<span class=\"token punctuation\">:</span><span class=\"token operator\">@</span><span class=\"token punctuation\">{</span> <span class=\"token string\">@&quot;item&quot;</span><span class=\"token punctuation\">:</span> <span class=\"token string\">@&quot;Cat Feather Toy&quot;</span><span class=\"token punctuation\">,</span>\n                                         <span class=\"token string\">@&quot;revenue&quot;</span><span class=\"token punctuation\">:</span> <span class=\"token string\">@&quot;9.99&quot;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This example <code class=\"language-text\">track</code> call tells us that a user just triggered an &quot;Item Purchased&quot; event for an <code class=\"language-text\">item</code> called &quot;Cat Feather Toy&quot; and <code class=\"language-text\">revenue</code> of 9.99.</p>\n<p><strong>Note:</strong> In order to use a <code class=\"language-text\">track</code> call, you must specify a name for the event you want to track whereas properties and options are all optional fields.</p>\n<p>A lot of analytics tools support custom event mapping so, with <code class=\"language-text\">track</code> implemented, you&#x2019;ll be able to attribute events to your users and start targeting them in a more informed and relevant way.</p>\n<h2 id=\"queue-flushing\" style=\"position:relative;\"><a href=\"#queue-flushing\" aria-label=\"queue flushing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Queue Flushing</h2>\n<p>You can specify the number of events that should queue before flushing. Set this to 1 to send events as they come in (i.e. not batched) but note that it will use more battery. Also note that this is 20 by default.</p>\n<div class=\"gatsby-highlight\" data-language=\"objectivec\"><pre class=\"language-objectivec\"><code class=\"language-objectivec\">SEGAnalyticsConfiguration <span class=\"token operator\">*</span>configuration <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>SEGAnalyticsConfiguration configurationWithSourceID<span class=\"token punctuation\">:</span><span class=\"token string\">@&quot;YOUR_SOURCE_ID&quot;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\nconfiguration<span class=\"token punctuation\">.</span>flushAt <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span>SEGAnalytics setupWithConfiguration<span class=\"token punctuation\">:</span>configuration<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Alternatively, you can <code class=\"language-text\">flush</code> the queue manually:</p>\n<div class=\"gatsby-highlight\" data-language=\"objectivec\"><pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>SEGAnalytics sharedAnalytics<span class=\"token punctuation\">]</span> alias<span class=\"token punctuation\">:</span><span class=\"token string\">@&quot;marthastewart&quot;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>SEGAnalytics sharedAnalytics<span class=\"token punctuation\">]</span> flush<span class=\"token punctuation\">]</span></code></pre></div>\n<h2 id=\"submitting-to-the-app-store\" style=\"position:relative;\"><a href=\"#submitting-to-the-app-store\" aria-label=\"submitting to the app store permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Submitting to the App Store</h2>\n<p>When submitting to the App Store, beware that MetaRouter collects the IDFA for use in doing mobile install attribution with destinations like Mobile App Tracking. Even if you&#x2019;re not currently doing mobile install attribution, if you get asked, &#x201C;Does this app use the Advertising Identifier (IDFA)?&#x201D; on this page, you&#x2019;ll want to check the following three boxes:</p>\n<ol>\n<li>&quot;Attribute this app to a previously sent advertisement&quot;</li>\n<li>&#x201C;Attribute an action taken within this app to a previously served advertisement&#x201D;</li>\n<li>&#x201C;I, YOUR_NAME, confirm that this app, and any third party&#x2026;&#x201D;</li>\n</ol>\n<p>Unless you are actually going to display ads in your app, do not check the box labeled &quot;Serve advertisements within the app&quot;.</p>\n<p>Congratulations, you can now use MetaRouter Analytics in your iOS app! Time to start hitting your business with insightful user data.</p></body></html>\n    </section>\n    <div class=\"section-border\"></div>\n  "}}}